from bs4 import BeautifulSoup as soup
import requests

def simple_get(url):
	res = requests.get(url)
	try:
		res.raise_for_status()
	except Exception as exc:
		print('Error: %s' % (exc))
	else:
		return soup(res.text, 'html.parser')


main_site = 'https://www.bmstores.co.uk/stores'
html_page = simple_get(main_site)
columns = html_page.find_all("div", {"class": "col-xs-4"})
for column in columns[0:3]:
	counties = column.text.split('\n')
	for county in counties[1: len(counties)]:
		county_name = county
		print('C: ' + county_name)

for a in column.find_all('a', href=True):
	second_site = main_site + a['href']
	second_html_page = simple_get(second_site)	
	store_details = second_html_page.find_all("th", {"style": "width: 50%;"})
	for store_detail in store_details:
		print(store_detail.a['href'])
